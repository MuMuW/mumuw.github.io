---
layout: post
title: RxJava系列
categories: Java
description: RxJava相关总结
keywords: Android, RxJava,链式调用,java
tags: Android, RxJava,链式调用,java

---

## Observer 观察者

### 创建 Observer 观察者

1. 实现Observer接口

	```
	Observer<String> observer = new Observer<String>() {
	    @Override
	    public void onNext(String s) {
	        Log.d(tag, "Item: " + s);
	    }
	
	    @Override
	    public void onCompleted() {
	        Log.d(tag, "Completed!");
	    }
	
	    @Override
	    public void onError(Throwable e) {
	        Log.d(tag, "Error!");
	    }
	};
	
	```

2. 使用Subscriber（Subscriber实现了Observer接口）

	-  在 RxJava 的 subscribe 过程中，Observer 也总是会先被转换成一个 Subscriber 再使用
	
	- Subscriber 新增方法
		1. onStart()：在 subscribe 刚开始，而事件还未发送之前被调用，可以用于做一些准备工作，例如数据的清零或重置。这是一个可选方法，默认情况下它的实现为空(如果对准备工作的线程有要求（例如弹出一个显示进度的对话框，这必须在主线程执行）， onStart() 就不适用了，因为它总是在 subscribe 所发生的线程被调用，而不能指定线程。)
		2. unsubscribe()：Subscriber 所实现的另一个接口 Subscription 的方法，用于取消订阅。在这个方法被调用后，Subscriber 将不再接收事件。
		
```
Subscriber<String> subscriber = new Subscriber<String>() {
    @Override
    public void onNext(String s) {
        Log.d(tag, "Item: " + s);
    }

    @Override
    public void onCompleted() {
        Log.d(tag, "Completed!");
    }

    @Override
    public void onError(Throwable e) {
        Log.d(tag, "Error!");
    }
};

```

## Observable 被观察者

### 创建 Observable 被观察者

```
Observable observable = Observable.create(new Observable.OnSubscribe<String>() {
    @Override
    public void call(Subscriber<? super String> subscriber) {
        subscriber.onNext("Hello");
        subscriber.onNext("Hi");
        subscriber.onNext("Aloha");
        subscriber.onCompleted();
    }
});

```

> OnSubscribe 会被存储在返回的 Observable 对象中，它的作用相当于一个计划表，当 Observable 被订阅的时候，OnSubscribe 的 call() 方法会自动被调用，事件序列就会依照设定依次触发（对于上面的代码，就是观察者Subscriber 将会被调用三次 onNext() 和一次 onCompleted()）。这样，由被观察者调用了观察者的回调方法，就实现了由被观察者向观察者的事件传递，即观察者模式。




