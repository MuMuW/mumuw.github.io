---
layout: post
title: Java内存体系
categories: Java
description: Java内存体系
keywords: Java内存体系
tags:  Java内存体系

---

## 内存区域划分

> 程序的执行过程

![](/assets/images/java/java_memory.png)

1. 执行过程先把程序代码加载到内存区
2. 操作系统找到main方法，开始运行程序
3. 内存中分为四块区域
	1. 堆：存放new出来的对象等
	2. 栈：存放局部变量
	3. 数据区：存放静态变量、字符串常量
	4. 代码区：存放代码
	
> 数据类型

![](/assets/images/java/data_type.png)

- 所有引用类型在内存里都占两块内存

> 基础类型

`int i = 0;`

- 内存图解

![](/assets/images/java/java_momory_int.png)

> 引用类型

```
 //声明了一个string类型的引用变量，但是没有指向一个对象
 String str;
 //使用new语句创建一个string类型对象并用str指向它
 str = new String("hello world");

```

> 内存中图解

![](/assets/images/java/java_memory_string.png)

```
public class Dog{
	int id;
	int age;
	Dog(int id,int age){
		this.id = id;
		this.age = age;
	}
}

Dog d = new Dog(1,15);

```

1. 在栈中创建Dog d的引用,调用构造方法并分配参数占用的栈空间
 
![](/assets/images/java/java_memory_dog1.png)

2. 在堆中分配d占用的内存,并包含id、age两个变量

![](/assets/images/java/java_memory_dog2.png)

3. 栈中的d引用指向堆中的d,并且回收栈中的参数占用的空间

![](/assets/images/java/java_memory_dog3.png)


- 例2

```
public class Cat{
    private static int sid = 0;
    private String name;
    int id;
    Cat(String name){
        this.name = name;
        id = sid ++;
    }
    
    public void info(){
        System.out.println("My name is" + name + "No." + id);
    }
    
    public static void main(String [] args){
        Cat.sid = 100;
        Cat cat1 = new Cat("mimi");		①
        Cat cat2 = new Cat("Cat2");		②
        cat1.info();
        cat2.info();
    }
}
```

> ①语句内存图解

![](/assets/images/java/java_memory_static1.png)

![](/assets/images/java/java_memory_static2.png)



